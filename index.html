<!DOCTYPE html>
<html>
	<head>
		<title>OptionsTracker</title>
		<link rel='stylesheet' href='public/index.css'>
		<link rel='stylesheet' href='public/tiles.css'>
	</head>
	<body>
		<header id='header'>
			<button class='windowButton' id='exitButton'></button><button class='windowButton' id='minimizeButton'></button>
		</header>
		<div id='main'>
			<div class='tile' id='progressTile'>
				<svg class="progress-ring" height="225" width="380">
					<g>
						<circle class="bottom__circle" stroke='#EEEEEE' stroke-width="2" fill='transparent' r="98" cx="187" cy="112" />
						<circle class="progress-ring__circle" stroke='#14CF66' stroke-width="4" fill='transparent' r="98" cx="187" cy="112"/>
						<text id='progressText' x='155' y='120' font-size='38' font-weight='550'>15%</text>
						<text x='165' y='140' font-size='12' fill='#545454'>TO GOAL</text>
					</g>
				</svg>
				<button class="timeFrame active" id="daily">DAILY</button><button class="timeFrame" id="weekly">WEEKLY</button><button class="timeFrame" id="monthly">MONTHLY</button>
			</div>
			<div class='tile' id='orderTile'>

			</div>
			<div class='tile' id='chartTile'>
				<p>PROGRESS</p>
				<h2>1.5K</h2>
				<svg height="178.203" width="300">
					<!-- <path d="M 0 135 C 20 95 40 95, 60 95 S 80 60, 120 60 S 160 9, 180 9 S 220 160, 240 160 S 280 83 300 83" stroke='#14CF66' fill='transparent' stroke-width='3'/> -->
					<path id='pathGraph' stroke='#14CF66' fill='transparent' stroke-width='3'/>
					<path id='pathGraph2' stroke='#14CF66' fill='transparent' stroke-width='3'/>
					<path id='pathGraph3' stroke='#14CF66' fill='transparent' stroke-width='3'/>
					<path id='pathGraph4' stroke='#14CF66' fill='transparent' stroke-width='3'/>
					<path id='pathGraph5' stroke='#14CF66' fill='transparent' stroke-width='3'/>
				</svg>
			</div>
		</div>
	</body>
</html>

<script>
	let {ipcRenderer} = require('electron');

	let exitButton = document.getElementById('exitButton');
	exitButton.addEventListener('click', (e) => {
		e.preventDefault;
		ipcRenderer.send('exitButton');
	});

	let minimizeButton = document.getElementById('minimizeButton');
	minimizeButton.addEventListener('click', (e) => {
		e.preventDefault;
		ipcRenderer.send('minimizeButton');
	});

	var circle = document.querySelector('.progress-ring__circle');
	var radius = circle.r.baseVal.value;
	var circumference = radius * 2 * Math.PI;

	circle.style.strokeDasharray = `${circumference} ${circumference}`;
	circle.style.strokeDashoffset = `${circumference}`;

	function setProgress(percent) {
		const offset = circumference - percent / 100 * circumference;
		circle.style.strokeDashoffset = offset;
	}

	let progressText = document.querySelector('#progressText');

	setProgress(15);

	let dailyButton = document.querySelector('#daily');
	dailyButton.addEventListener('click', () => {
		dailyButton.classList = 'timeFrame active';
		weeklyButton.classList = 'timeFrame';
		monthlyButton.classList = 'timeFrame';
		setProgress(15);
		progressText.textContent = '15%';
	});

	let weeklyButton = document.querySelector('#weekly');
	weeklyButton.addEventListener('click', () => {
		dailyButton.classList = 'timeFrame';
		weeklyButton.classList = 'timeFrame active';
		monthlyButton.classList = 'timeFrame';
		setProgress(50);
		progressText.textContent = '50%';
	});

	let monthlyButton = document.querySelector('#monthly');
	monthlyButton.addEventListener('click', () => {
		dailyButton.classList = 'timeFrame';
		weeklyButton.classList = 'timeFrame';
		monthlyButton.classList = 'timeFrame active';
		setProgress(75);
		progressText.textContent = '75%';
	});

	let pathGraph = document.querySelector('#pathGraph');
	let pathGraph2 = document.querySelector('#pathGraph2');
	let pathGraph3 = document.querySelector('#pathGraph3');
	let pathGraph4 = document.querySelector('#pathGraph4');
	let pathGraph5 = document.querySelector('#pathGraph5');
	let portfolio = [450,900,1500,500,475];
	let portfolioMin = Math.min(...portfolio);
	let portfolioMax = Math.max(...portfolio);
	let portfolioRange = portfolioMax - portfolioMin;
	let portfolioScale = portfolioRange/160;
	let baseY = 84;
	let baseYDollar = portfolioMax - portfolioRange * .5;
	let startingOpen, startingBezier, secondBezier, thirdBezier, fourthBezier, fifthBezier;

	startingOpen = baseY + (baseYDollar - portfolio[0]) / portfolioScale;
	if(startingOpen > baseY) {startingOpen = startingOpen + 30}
		else {startingOpen = startingOpen - 30}
	startingBezier = baseY + (baseYDollar - portfolio[0]) / portfolioScale;
	secondBezier = startingBezier - (portfolio[1] - portfolio[0]) / portfolioScale;
	thirdBezier = secondBezier - (portfolio[2] - portfolio[1]) / portfolioScale;
	fourthBezier = thirdBezier - (portfolio[3] - portfolio[2]) / portfolioScale;
	fifthBezier = fourthBezier - (portfolio[4] - portfolio[3]) / portfolioScale;

	pathGraph.setAttribute('d', `M 0 ${startingOpen} C 20 ${startingBezier} 40 ${startingBezier}, 60 ${startingBezier} `);
	pathGraph2.setAttribute('d', `M 60 ${startingBezier} C 80 ${startingBezier} 80 ${secondBezier} 120 ${secondBezier}`);
	pathGraph3.setAttribute('d', `M 120 ${secondBezier} C 160 ${secondBezier} 160 ${thirdBezier} 180 ${thirdBezier}`);
	pathGraph4.setAttribute('d', `M 180 ${thirdBezier} C 200 ${thirdBezier} 220 ${fourthBezier} 240 ${fourthBezier}`);
	pathGraph5.setAttribute('d', `M 240 ${fourthBezier} C 260 ${fourthBezier} 280 ${fifthBezier} 300 ${fifthBezier}`);


	pathGraph.addEventListener('mouseover', () => {
		document.querySelector('#chartTile h2').textContent = portfolio[0];
		pathGraph2.style = 'opacity: 0.4;'
		pathGraph3.style = 'opacity: 0.4;'
		pathGraph4.style = 'opacity: 0.4;'
		pathGraph5.style = 'opacity: 0.4;'

		pathGraph.addEventListener('mouseout', () => {
			setTimeout(() => {
				document.querySelector('#chartTile h2').textContent = portfolio[4];
				pathGraph2.style = 'opacity: 1;'
				pathGraph3.style = 'opacity: 1;'
				pathGraph4.style = 'opacity: 1;'
				pathGraph5.style = 'opacity: 1;'
			}, 75);
		})
	})
	pathGraph2.addEventListener('mouseover', () => {
		document.querySelector('#chartTile h2').textContent = portfolio[1];
		pathGraph.style = 'opacity: 0.4;'
		pathGraph3.style = 'opacity: 0.4;'
		pathGraph4.style = 'opacity: 0.4;'
		pathGraph5.style = 'opacity: 0.4;'

		pathGraph2.addEventListener('mouseout', () => {
			setTimeout(() => {
				document.querySelector('#chartTile h2').textContent = portfolio[4];
				pathGraph.style = 'opacity: 1;'
				pathGraph3.style = 'opacity: 1;'
				pathGraph4.style = 'opacity: 1;'
				pathGraph5.style = 'opacity: 1;'
			}, 75);
		})
	})
	pathGraph3.addEventListener('mouseover', () => {
		document.querySelector('#chartTile h2').textContent = portfolio[2];
		pathGraph2.style = 'opacity: 0.4;'
		pathGraph.style = 'opacity: 0.4;'
		pathGraph4.style = 'opacity: 0.4;'
		pathGraph5.style = 'opacity: 0.4;'

		pathGraph3.addEventListener('mouseout', () => {
			setTimeout(() => {
				document.querySelector('#chartTile h2').textContent = portfolio[4];
				pathGraph2.style = 'opacity: 1;'
				pathGraph.style = 'opacity: 1;'
				pathGraph4.style = 'opacity: 1;'
				pathGraph5.style = 'opacity: 1;'
			}, 75);
		})
	})
	pathGraph4.addEventListener('mouseover', () => {
		document.querySelector('#chartTile h2').textContent = portfolio[3];
		pathGraph2.style = 'opacity: 0.4;'
		pathGraph3.style = 'opacity: 0.4;'
		pathGraph.style = 'opacity: 0.4;'
		pathGraph5.style = 'opacity: 0.4;'

		pathGraph4.addEventListener('mouseout', () => {
			setTimeout(() => {
				document.querySelector('#chartTile h2').textContent = portfolio[4];
				pathGraph2.style = 'opacity: 1;'
				pathGraph3.style = 'opacity: 1;'
				pathGraph.style = 'opacity: 1;'
				pathGraph5.style = 'opacity: 1;'
			}, 75);
		})
	})
	pathGraph5.addEventListener('mouseover', () => {
		document.querySelector('#chartTile h2').textContent = portfolio[4];
		pathGraph2.style = 'opacity: 0.4;'
		pathGraph3.style = 'opacity: 0.4;'
		pathGraph4.style = 'opacity: 0.4;'
		pathGraph.style = 'opacity: 0.4;'

		pathGraph5.addEventListener('mouseout', () => {
			setTimeout(() => {
				document.querySelector('#chartTile h2').textContent = portfolio[4];
				pathGraph2.style = 'opacity: 1;'
				pathGraph3.style = 'opacity: 1;'
				pathGraph4.style = 'opacity: 1;'
				pathGraph.style = 'opacity: 1;'
			}, 75);
		})
	})
</script>